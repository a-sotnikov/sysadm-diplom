# –î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ ¬´–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä¬ª - –ê–Ω–¥—Ä–µ–π –°–æ—Ç–Ω–∏–∫–æ–≤

- [–î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ ¬´–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä¬ª - –ê–Ω–¥—Ä–µ–π –°–æ—Ç–Ω–∏–∫–æ–≤](#–¥–∏–ø–ª–æ–º–Ω–∞—è-—Ä–∞–±–æ—Ç–∞-–ø–æ-–ø—Ä–æ—Ñ–µ—Å—Å–∏–∏-—Å–∏—Å—Ç–µ–º–Ω—ã–π-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä---–∞–Ω–¥—Ä–µ–π-—Å–æ—Ç–Ω–∏–∫–æ–≤)
  - [–°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ü–û](#—Å–ø–∏—Å–æ–∫-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ-–ø–æ)
  - [–ü–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è](#–ø–ª–∞–Ω-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)
  - [–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã Yandex.Cloud](#–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ-—Ä–µ—Å—É—Ä—Å—ã-yandexcloud)
    - [–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã](#–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-–º–∞—à–∏–Ω—ã)
    - [–°–µ—Ç—å –∏ —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ](#—Å–µ—Ç—å-–∏-—Å–µ—Ç–µ–≤–æ–µ-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
      - [L7 –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏](#l7-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫-–Ω–∞–≥—Ä—É–∑–∫–∏)
    - [Terraform](#terraform)
      - [–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞](#—Å–≤–æ–¥–Ω–∞—è-—Ç–∞–±–ª–∏—Ü–∞)
      - [–£—Å–ª–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞ —Å–µ—Ç–∏](#—É—Å–ª–æ–≤–Ω–∞—è-—Å—Ö–µ–º–∞-—Å–µ—Ç–∏)
  - [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é Ansible](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-—Å–µ—Ä–≤–∏—Å–æ–≤-—Å-–ø–æ–º–æ—â—å—é-ansible)
    - [–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Ansible](#—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π-ansible)
      - [–†–æ–ª–∏](#—Ä–æ–ª–∏)
  - [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
    - [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
    - [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-—Å–µ—Ä–≤–∏—Å–æ–≤)
    - [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)
    - [–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤](#—Å–æ–∑–¥–∞–Ω–∏–µ-–¥–∞—à–±–æ—Ä–¥–æ–≤)
      - [Kibana](#kibana)
      - [Grafana](#grafana)
  - [–°—Å—ã–ª–∫–∏](#—Å—Å—ã–ª–∫–∏)

## –°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ü–û

| SW | –í–µ—Ä—Å–∏—è |
| --- | --- |
| Ansible | 2.14.11 |
| Terraform | 1.6.3 |

## –ü–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

0. –ü–æ–ª—É—á–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ Yandex.Cloud –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–ª–∞—á–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ —á–µ—Ä–µ–∑ Terraform.
1. –°–æ–∑–¥–∞–Ω–∏–µ [—Ä–µ—Å—É—Ä—Å–æ–≤](#–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ-—Ä–µ—Å—É—Ä—Å—ã-yandexcloud) –ø—Ä–∏ –ø–æ–º–æ—â–∏ Terraform.
2. –í —Ö–æ–¥–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—É—Ä–∫—Ç—É—Ä—ã –Ω–∞ Bastion —Å–µ—Ä–≤–µ—Ä —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è Git –∏ Ansible, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ansible.cfg, –∑–∞—Ç–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–æ–ª–µ–π Ansible –∏–∑ VCS (GitHub).
3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH –∫ Bastion —Å–µ—Ä–≤–µ—Ä—É –∏ –∑–∞–ø—É—Å–∫ –ø–ª–µ–π–±—É–∫–æ–≤ Ansible –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤—Ä—É—á–Ω—É—é, —á–µ—Ä–µ–∑ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ CI/CD-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Jenkins).
4. –ó–∞–ø—É—Å–∫ –ø–ª–µ–π–±—É–∫–∞ Ansible –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏ [—Ä–æ–ª–µ–π](#—Ä–æ–ª–∏).
5. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤ –≤ Grafana –∏ Kibana.

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã Yandex.Cloud

### –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã

–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ–º–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö. –í –∫–∞—á–µ—Å—Ç–≤–µ –û–° –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Fedora 37.  
–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω—ç–ø—à–æ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –¥–∏—Å–∫–æ–≤, —Å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º.  

–°–ø–∏—Å–æ–∫ –í–ú —Å –∑–∞—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.

### –°–µ—Ç—å –∏ —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –ø–æ–¥—Å–µ—Ç–∏ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (–≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∑–æ–Ω–∞—Ö) –∏ –æ–¥–Ω–∞ –ø—É–±–ª–∏—á–Ω–∞—è –ø–æ–¥—Å–µ—Ç—å. –î–æ—Å—Ç—É–ø –≤–æ –≤–Ω–µ –µ—Å—Ç—å —Å–æ –≤—Å–µ—Ö –º–∞—à–∏–Ω, –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ NAT-—à–ª—é–∑, —Ç—Ä–∞—Ñ–∏–∫ –≤ –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ç–∞–±–ª–∏—Ü—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏. –î–æ—Å—Ç—É–ø –∫ –º–∞—à–∏–Ω–∞–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å –ø–æ–º–æ—â—å—é security groups - –æ—Ç–∫—Ä—ã—Ç—ã —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã.  
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω–µ –ø—Ä–∏—Å–≤–æ–µ–Ω–∞ DNS-–∑–∞–ø–∏—Å—å –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏.

#### L7 –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏

–î–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è L7-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ (Application Load Balancer), –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã, –±—ç–∫–µ–Ω–¥-–≥—Ä—É–ø–ø—ã, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏, —Ä–æ—É—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –≥—Ä—É–ø–ø—É –±—ç–∫–µ–Ω–¥–∞ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –±—ç–∫–µ–Ω–¥–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

### Terraform

–í—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–µ —Ä–µ—Å—É—Ä—Å—ã —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ HashiCorp Terraform —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º YandexCloud.
–î–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–±–∏—Ç–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤:

- **main.tf** - —Å–ª—É–∂–µ–±–Ω—ã–π —Ñ–∞–π–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è–º–∏ –≤—ã–≤–æ–¥–∞.
- **bastion.tf**, **logs.tf**, **monitoring.tf** –∏ **webservers.tf** - —Ñ–∞–π–ª—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–∏—Å–∞–Ω—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã. –ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å –∏–ª–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –í–ú. –ó–¥–µ—Å—å –∂–µ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –¥–∏—Å–∫–æ–≤.
- **load_balancer.tf** - —Ñ–∞–π–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è L7 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏.
- **network.tf** - —Ñ–∞–π–ª, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ç–∏. –í –Ω–µ–º –∑–∞–¥–∞—é—Ç—Å—è –ø–æ–¥—Å–µ—Ç–∏, —à–ª—é–∑, —Ç–∞–±–ª–∏—Ü–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏ –≤—Å–µ –≥—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–ü–æ–º–∏–º–æ —ç—Ç–æ–≥–æ, –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –í–ú –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–∞–π–ª —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ meta.yml, –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ—Ç–æ—Ä–æ–º—É –Ω–∞ –≤—Å–µ—Ö –º–∞—à–∏–Ω–∞—Ö, –∫—Ä–æ–º–µ bastion, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω—É–∂–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (ansible) —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ authorized_keys. –° –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ –∫–ª—é—á–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –±–µ—Å–ø–∞—Ä–æ–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ansible-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –∫ —Ö–æ—Å—Ç–∞–º. –§–∞–π–ª bastion.yml —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –Ω–æ —É–∂–µ –¥–ª—è bastion-—Ö–æ—Å—Ç–∞. –ö—Ä–æ–º–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤ –Ω–µ–º –∑–∞–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (`git` –∏ `ansible`), –∞ —Ç–∞–∫–∂–µ –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è [diplom_ansible](https://github.com/a-sotnikov/diplom_ansible).

#### –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ü–ü–û | CPU | RAM | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π FQDN | –ü–æ–¥—Å–µ—Ç—å |
| --- | --- | --- | --- | --- | --- |
| webserver-1 | Nginx | 2 | 2G | web1.dip.lom | private-subnet-a |
| webserver-2 | Nginx | 2 | 2G | web2.dip.lom | private-subnet-b |
| prometheus | Prometheus | 2 | 4G | prometheus.dip.lom | private-subnet-b |
| grafana | Grafana | 2 | 2G | grafana.dip.lom | public-subnet |
| elaticsearch | ElaticSearch (in Docker) | 2 | 4G | es.dip.lom | private-subnet-a |
| kibana | Kibana (in Docker) | 2 | 4G | kibana.dip.lom | public-subnet |
| bastion-host | Ansible | 2 | 1G | bastion.dip.lom | public-subnet |

#### –£—Å–ª–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞ —Å–µ—Ç–∏

![Network](materials/screenshots/network.png)

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é Ansible

–¢–∞–∫ –∫–∞–∫ —ç—Ç–æ—Ç —à–∞–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –≤ —Ç–æ–º —á–∏—Å–ª–µ, –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, Ansible-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω –Ω–∞ Bastion-—Å–µ—Ä–≤–µ—Ä–µ, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–º–µ–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –ø–æ SSH –Ω–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã.

–í–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è Bastion –Ω–∞ –Ω–µ–≥–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–∞–∫–µ—Ç—ã `git` –∏ `ansible`, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `git clone` —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –ø–ª–µ–π–±—É–∫–æ–º –∏ —Ä–æ–ª—è–º–∏ Ansible.

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Ansible

–°–æ—Å—Ç–∞–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

- **ansible.cfg** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª ansible;
- **ansible.key** - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –í–ú –ø–æ SSH. –ß—Ç–æ–±—ã –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ, –æ–Ω –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –ø—Ä–∏ –ø–æ–º–æ—â–∏ —É—Ç–∏–ª–∏—Ç—ã `ansible vault`. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–ª–µ–π–±—É–∫–∞. –î–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ `--ask-vault-pass=` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–ª–µ–π–±—É–∫–∞;
- **config.yml** - —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–ª–µ–π–±—É–∫–∞. –í –Ω–µ–º –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞). –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–æ–∂–µ –≤—ã–≤–µ–¥–µ–Ω—ã –≤ —ç—Ç–æ—Ç —Ñ–∞–π–ª;
- **inventory.yml** - —Ñ–∞–π–ª —Å –ø–µ—Ä–µ—á–Ω–µ–º —Ö–æ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–¥—Ä–µ—Å–∞ —Ö–æ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DNS-–∑–∞–ø–∏—Å—å, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –ø—Ä–∞–≤–∏—Ç—å IP-–∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–¥–µ–ø–ª–æ–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ó–¥–µ—Å—å –∂–µ –ø—É—Ç–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ—á–µ–Ω—å —Ö–æ—Å—Ç–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ—Ç –∏–ª–∏ –∏–Ω–æ–π —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ö–æ—Å—Ç –≤ –≥—Ä—É–ø–ø—É docker, –Ω–∞ –Ω–µ–≥–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è docker);
- **playbook.yml** - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–ª–µ–π–±—É–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –∞ –∑–∞—Ç–µ–º –ø–æ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –¥–µ–ø–ª–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–æ–ª–∏.

#### –†–æ–ª–∏

1. **webservers** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `Nginx` –∏ —Å—Ç–∞—Ç–∏–∫–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏;
1. **metrics** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ (`NodeExporter`, `NgninxlogExporter`);
1. **grafana** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `Grafana`;
1. **prometheus** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `Prometheus`;
1. **docker** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ docker –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –¥–ª—è `ElasticSearch` –∏ `Kibana`;
1. **elasticsearch** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `Elasticsearch`;
1. **kibana** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `Kibana`;
1. **fluent-bit**/filebeat* - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–±–æ—Ä—â–∏–∫–∞ –ª–æ–≥–æ–≤;

> *–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –∫–∞—á–µ—Å—Ç–≤–µ beat –≤—ã–±—Ä–∞–Ω `fluent-bit`, —Ç–∞–∫ –∫–∞–∫ `filebeat` –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–≤–æ–±–æ–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏, –∞ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏ –ø—Ä–æ–∫–∏–¥—ã–≤–∞—Ç—å —Ç—É–¥–∞ –ª–æ–≥–∏ nginx –∫–∞–∂–µ—Ç—Å—è –Ω–µ —Å–∞–º—ã–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º, –ø–ª—é—Å –µ—Å—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –ø—Ä–∞–≤–∞–º–∏. –û–¥–Ω–∞–∫–æ, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `docker` –∏ `filebeat` –µ—Å—Ç—å, –Ω—É–∂–Ω–æ –ª–∏—à—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å inventory-—Ñ–∞–π–ª, –¥–æ–±–∞–≤–∏–≤ –≤ –≥—Ä—É–ø–ø—É `docker-servers` —Ö–æ—Å—Ç—ã —Å `nginx`, –∏ —Ä–∞—Å–∫–æ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–∞—Å–∫—É –≤ –ø–ª–µ–π–±—É–∫–µ.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º Terraform.

```sh
‚ùØ terraform --version
Terraform v1.6.3
on linux_amd64
+ provider registry.terraform.io/yandex-cloud/yandex v0.92.0
```

–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Ñ–∞–π–ª—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –¥–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/terraform`. –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –Ω–µ–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π

```sh
‚ùØ terraform apply
```

[–§–∞–π–ª —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º stdout](materials/logs/terraform_apply.log)

–í –∫–æ–Ω—Ü–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–µ ip –∞–¥—Ä–µ—Å–∞ bastion-—Ö–æ—Å—Ç–∞, Grafana, Kibana –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏.

–í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Yandex.Cloud:  
![–í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Yandex.Cloud](materials/screenshots/yc.png)

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

–î–ª—è –¥–µ–ø–ª–æ—è —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ ssh –Ω–∞ bastion-—Å–µ—Ä–≤–µ—Ä. –¢–∞–∫ –∫–∞–∫ –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –Ω–∞ –Ω–µ–≥–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω–∞—è —á–∞—Å—Ç—å –∫–ª—é—á–∞, –ø—Ä–∏–≤–∞—Ç–Ω–∞—è –∂–µ - –Ω–∞ –º–æ–µ–π –º–∞—à–∏–Ω–µ. –ü–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç—É–ø –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –±–µ–∑ –ø–∞—Ä–æ–ª—è.

–í –¥–æ–º–∞—à–Ω–µ–π –ø–∞–ø–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ansible —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π [diplom_ansible](https://github.com/a-sotnikov/diplom_ansible), –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ Github –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á `ansible.key`, —Å –∫–æ—Ç–æ—Ä—ã–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã—Ö –º–∞—à–∏–Ω, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –ø–∞—Ä–æ–ª–µ–º —á–µ—Ä–µ–∑ `ansible-vault`. –î–ª—è –µ–≥–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–æ–π `ansible-vault decrypt <file>`, –Ω–æ —ç—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ –≤ –ø–ª–µ–π–±—É–∫ –ø–µ—Ä–≤–æ–π –∂–µ play, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π

```sh
ansible-playbook playbook.yml  --ask-vault-pass
```

–∏ –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å.

[–§–∞–π–ª —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º stdout](materials/logs/ansible-playbook.log)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–µ–π–±—É–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –º–æ–∂–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–µ—Ä–µ–π—Ç–∏ –ø–æ [IP-–∞–¥—Ä–µ—Å—É –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏](http://158.160.130.168/) –∏ —É–≤–∏–¥–µ—Ç—å —Å–∞–π—Ç. –ï—Å–ª–∏ –æ–±–Ω–æ–≤–∏–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ —Å–±—Ä–æ—Å–æ–º –∫—ç—à–∞, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑–º–µ–Ω–∏—Ç—Å—è (—Ç–∞–∫ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –ø–æ–π–¥–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–π nginx):

![–î–≤–∞ –æ–∫–æ—à–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏, –Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º IP](materials/screenshots/nginx_different_servers.png)

–°–¥–µ–ª–∞–Ω–æ —ç—Ç–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —à–∞–±–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ `index.html`.

–ü–æ IP-–∞–¥—Ä–µ—Å–∞–º [Grafana](http://158.160.40.237:3000/d/e6ddc2f2-9d9d-4e17-9ba3-37dac30f5bdf/web?orgId=1) –∏ [Kibana](http://62.84.125.92:5601/app/dashboards#/view/378ed110-8321-11ee-9830-ed4dc4ee4149?) —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–µ—Ä—ã.

### –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤

#### Kibana

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è Kibana —É–∂–µ –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ ElasticSearch –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π, –æ—Å—Ç–∞–µ—Ç—Å—è –ª–∏—à—å —Å–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –∏–Ω–¥–µ–∫—Å–æ–≤, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –≤—ã–Ω–µ—Å—Ç–∏ –∏—Ö –Ω–∞ –¥–∞—à–±–æ—Ä–¥ *(–∏ –≤–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—ÉüôÇ)*:

![–î–∞—à–±–æ—Ä–¥ —Å –ª–æ–≥–∞–º–∏ nginx](materials/screenshots/kibana.png)

#### Grafana

–ü–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –Ω—É–∂–Ω–æ –∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (admin/admin), –ø–æ–º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å Prometheus –≤ Data Sources:

![Data sources](materials/screenshots/grafana_data_sources.png)

–ó–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–∞—à–±–æ—Ä–¥:

![Dashboard](materials/screenshots/grafana_dashboard.png)

–ß–∞—Å—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø–æ–∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∞ –≤ —à–∞–±–ª–æ–Ω–µ Node Exporter Full (id 1860).

## –°—Å—ã–ª–∫–∏

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π Ansible - [github.com/a-sotnikov/diplom_ansible](https://github.com/a-sotnikov/diplom_ansible)  
Grafana - [158.160.40.237:3000](http://158.160.40.237:3000/d/e6ddc2f2-9d9d-4e17-9ba3-37dac30f5bdf/web?orgId=1)  
Kibana - [62.84.125.92:5601](http://62.84.125.92:5601/app/dashboards#/view/378ed110-8321-11ee-9830-ed4dc4ee4149?)  
–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ —Å —Å–∞–π—Ç–æ–º - [158.160.130.168:80](http://158.160.130.168/)
